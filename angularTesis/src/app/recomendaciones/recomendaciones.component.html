<section class="recomendaciones-container">
  <h1 class="titulo-principal">Recomendaci√≥n de Materias</h1>
  <p class="descripcion-seccion">
    Teniendo en cuenta tus gustos, preferencias y requerimientos espec√≠ficos,
    el sistema te ofrecer√° una recomendaci√≥n personalizada de materias.
  </p>

  <div class="formulario">
    <textarea [(ngModel)]="pregunta" name="pregunta"
      placeholder="Tema de inter√©s, gustos, preferencias para la tem√°tica central de la materia"></textarea>

    <!-- üëá Nuevo control de cr√©ditos -->
    <div class="creditos-control">
      <label for="creditos">N√∫mero de Cr√©ditos de la Materia</label>
      <div class="stepper">
        <input id="creditos" name="creditos" type="number" min="1" max="10" [(ngModel)]="creditos">
        <div class="buttons">
          <button type="button" class="btn-step btn-up" (click)="incCreditos()" [disabled]="cargando" aria-label="Aumentar cr√©ditos">+</button>
          <button type="button" class="btn-step btn-down" (click)="decCreditos()" [disabled]="cargando" aria-label="Disminuir cr√©ditos">‚àí</button>
        </div>
      </div>
    </div>

    <button (click)="consultarIA()" [disabled]="cargando">Generar Recomendaci√≥n</button>
  </div>

  <!-- Spinner -->
  <div *ngIf="cargando" class="mensaje-cargando">
    <div class="spinner"></div>
    <p>Consultando, un momento por favor...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !cargando" class="respuesta-box">
    <h3 class="titulo-respuesta">Error:</h3>
    <p>{{ error }}</p>
  </div>

  <!-- Resultado -->
  <div *ngIf="materias.length > 0 && !cargando" class="respuesta-box">
    <h3 class="titulo-respuesta">Materias recomendadas:</h3>

    <table class="tabla-materias">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Grado</th>
          <th>ID</th>
          <th>Cr√©ditos</th>
          <th>N¬∞ Cat√°logo</th>
          <th>N¬∞ Oferta</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let materia of materias">
          <td>{{ materia.nombre }}</td>
          <td>{{ materia.grado }}</td>
          <td>{{ materia.id }}</td>
          <td>{{ materia.creditos }}</td>
          <td>{{ materia.numero_catalogo }}</td>
          <td>{{ materia.numero_oferta }}</td>
        </tr>
      </tbody>
    </table>

    <p *ngIf="explicacion" class="explicacion-texto"><strong>Explicaci√≥n:</strong> {{ explicacion }}</p>
  </div>

  <!-- Caso sin resultados -->
  <div *ngIf="!cargando && !error && materias.length === 0 && explicacion" class="respuesta-box">
    <h3 class="titulo-respuesta">No se encontraron materias que coincidan con tu consulta.</h3>
  </div>
</section>