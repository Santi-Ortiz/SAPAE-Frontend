<div class="simulacion-container">
  <section class="titulo-simulacion">
    <h1>Simulaci√≥n de Escenarios Acad√©micos</h1>
    <p>Proyecta tu pr√≥ximo semestre con base en tus avances, pendientes y preferencias. Esta simulaci√≥n te sugiere las
      materias ideales seg√∫n tu situaci√≥n acad√©mica, ayud√°ndote a planificar mejor tu carga y avanzar de forma √≥ptima.
      Ahorra tiempo, evita errores de inscripci√≥n y planifica tu semestre con datos reales.</p>
    
    <!-- Informaci√≥n sobre el nuevo proceso -->
    <div class="info-proceso-asincrono">
      <h3>üí° ¬øC√≥mo funciona la simulaci√≥n?</h3>
      <ul>
        <li>‚úÖ Las simulaciones se procesan en segundo plano</li>
        <li>üöÄ Puedes navegar libremente mientras se calcula tu simulaci√≥n</li>
        <li>üîî Recibir√°s una notificaci√≥n cuando est√© lista</li>
      </ul>
    </div>
  </section>

  <section class="preferencias-academicas">
    <h2>Preferencias Acad√©micas</h2>
    <form class="form-vertical">
      <div class="form-group">
        <label for="semestreInput">Cantidad de Semestres a Proyectar</label>
        <input type="number" id="semestreInput" name="semestreInput" [(ngModel)]="semestreInput" />
      </div>

      <div class="form-group">
        <label for="tipoMatricula">Tipo de Matr√≠cula</label>
        <select id="tipoMatricula" name="tipoMatricula" [(ngModel)]="tipoMatricula" (change)="ajustarCreditos()">
          <option value="Media Matr√≠cula">Media Matr√≠cula</option>
          <option value="Matr√≠cula completa">Matr√≠cula completa</option>
          <option value="Matr√≠cula completa + 1 cr√©ditos">Matr√≠cula completa + 1 cr√©ditos</option>
          <option value="Matr√≠cula completa + 2 cr√©ditos">Matr√≠cula completa + 2 cr√©ditos</option>
          <option value="Matr√≠cula completa + 3 cr√©ditos">Matr√≠cula completa + 3 cr√©ditos</option>
          <option value="Matr√≠cula completa + 4 cr√©ditos">Matr√≠cula completa + 4 cr√©ditos</option>
        </select>
      </div>

      <div class="form-group">
        <label for="creditosInput">Cantidad M√°xima de Cr√©ditos a Inscribir</label>
        <input type="number" id="creditosInput" name="creditosInput" [(ngModel)]="creditosInput"
          [attr.max]="maxCreditos" (input)="ajustarCreditos()" />
        <small style="color: gray;">M√°ximo seg√∫n tipo de matr√≠cula: {{ maxCreditos }}</small>
      </div>

      <div class="form-group">
        <label for="materiasInput">Cantidad M√°xima de Materias a Inscribir</label>
        <input type="number" id="materiasInput" name="materiasInput" [(ngModel)]="materiasInput" />
      </div>
    </form>
  </section>

  <hr class="section-divider" />

  <section class="priorizacion-materias">
    <h2>Priorizaci√≥n de Materias</h2>
    <p>Selecciona las materias prioritarias para futuros semestres. Elije m√°ximo {{ maxSelecciones }} campos para mejorar la predicci√≥n en la simulaci√≥n.</p>
    <p><small style="color: gray;">Campos seleccionados: {{ seleccionesActuales }}/{{ maxSelecciones }}</small></p>
    
    <!-- Mensaje de error -->
    <p *ngIf="mostrarMensajeError" class="mensaje-error">
      ‚ö†Ô∏è No puedes seleccionar m√°s de {{ maxSelecciones }} campos de priorizaci√≥n.
    </p>
    
    <div class="checkbox-group">
      <div>
        <input 
          type="checkbox" 
          id="prioridad-nucleo-basicas"
          [checked]="priorizacionMaterias.nucleoCienciasBasicas"
          (change)="onCheckboxChange('nucleoCienciasBasicas', $event)" 
        /> 
        <label for="prioridad-nucleo-basicas">
          N√∫cleo de Ciencias B√°sicas (ej. C√°lculos, F√≠sicas, Qu√≠micas)
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-nucleo-aplicada"
          [checked]="priorizacionMaterias.nucleoIngenieriaAplicada"
          (change)="onCheckboxChange('nucleoIngenieriaAplicada', $event)" 
        /> 
        <label for="prioridad-nucleo-aplicada">
          N√∫cleo de Ingenier√≠a Aplicada (Espec√≠ficas de la carrera)
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-socio-humanistica"
          [checked]="priorizacionMaterias.nucleoSocioHumanistica"
          (change)="onCheckboxChange('nucleoSocioHumanistica', $event)" 
        /> 
        <label for="prioridad-socio-humanistica">
          N√∫cleo Socio-human√≠stica (ej. Teolog√≠as, √âticas)
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-electivas"
          [checked]="priorizacionMaterias.electivas"
          (change)="onCheckboxChange('electivas', $event)" 
        /> 
        <label for="prioridad-electivas">
          Electivas
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-complementarias"
          [checked]="priorizacionMaterias.complementarias"
          (change)="onCheckboxChange('complementarias', $event)" 
        /> 
        <label for="prioridad-complementarias">
          Complementarias
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-enfasis"
          [checked]="priorizacionMaterias.enfasis"
          (change)="onCheckboxChange('enfasis', $event)" 
        /> 
        <label for="prioridad-enfasis">
          √ânfasis
        </label>
      </div>
    </div>
  </section>

  <button class="simulacion-button" (click)="generarSimulacion()">Generar Simulaci√≥n</button>
</div>


<div *ngIf="resultadoSimulacion">
  <div *ngFor="let semestre of resultadoSimulacion | keyvalue">
    <h2>Semestre {{ semestre.key }}</h2>
    <ul *ngIf="semestre.value.materias">
      <li *ngFor="let materia of semestre.value.materias">
        <strong>{{ materia.nombre }}</strong> (C√≥digo: {{ materia.codigo }})<br />
        Cr√©ditos: {{ materia.creditos }}<br />
        Requisitos:
        <ul>
          <li *ngFor="let req of materia.requisitos">{{ req }}</li>
        </ul>
      </li>
    </ul>
  </div>
</div>