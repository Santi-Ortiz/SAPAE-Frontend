<div class="simulacion-container">
  <section class="titulo-simulacion">
    <h1>Simulaci√≥n de Escenarios Acad√©micos</h1>
    <p>Proyecta tu pr√≥ximo semestre con base en tus avances, pendientes y preferencias. Esta simulaci√≥n te sugiere las
      materias ideales seg√∫n tu situaci√≥n acad√©mica, ayud√°ndote a planificar mejor tu carga y avanzar de forma √≥ptima.
      Ahorra tiempo, evita errores de inscripci√≥n y planifica tu semestre con datos reales.</p>
    
    <!-- Informaci√≥n sobre el nuevo proceso -->
    <div class="info-proceso-asincrono">
      <h3>üí° ¬øC√≥mo funciona la simulaci√≥n?</h3>
      <ul>
        <li>‚úÖ Las simulaciones se procesan en segundo plano</li>
        <li>üöÄ Puedes navegar libremente mientras se calcula tu simulaci√≥n</li>
        <li>üîî Recibir√°s una notificaci√≥n cuando est√© lista</li>
      </ul>
    </div>
      <button class="historial-button" (click)="verHistorialSimulaciones()">Ver Historial de Simulaciones</button>
  </section>

  <section class="preferencias-academicas">
    <h2>Nombre de la Simulaci√≥n</h2>
    <div class="form-group">
      <label for="nombreSimulacion">Ingresa un nombre para la simulaci√≥n</label>
      <input type="text" id="nombreSimulacion" name="nombreSimulacion" [(ngModel)]="nombreSimulacion" 
             placeholder="Ej: Mi simulaci√≥n semestre 2025-2" maxlength="50" />
      <small style="color: gray;">Este nombre servir√° para identificar cada simulaci√≥n que realice</small>
    </div>
  </section>

  <section class="preferencias-academicas">
    <h2>Preferencias Acad√©micas</h2>
    <p>Configura c√≥mo quieres simular tu avance acad√©mico seleccionando cu√°ntos semestres proyectar√°s, el tipo de matr√≠cula, los l√≠mites de cr√©ditos y materias por semestre.</p>
    <form>
      <div class="form-grid">
        <div class="form-block">
          <div class="form-block-subtitle">Configuraci√≥n General</div>

          <div class="form-group">
            <label for="semestreInput">Cantidad de Semestres a Simular</label>
            <input type="number" id="semestreInput" name="semestreInput" [(ngModel)]="semestreInput" min="1" />
            <small style="color: gray;">Se simular√°n {{ semestreInput }} semestres hacia adelante</small>
          </div>
        
          <div class="form-group">
            <label for="tipoMatricula">Tipo de Matr√≠cula</label>
            <select id="tipoMatricula" name="tipoMatricula" [(ngModel)]="tipoMatricula" (change)="ajustarCreditos()">
              <option value="Media Matr√≠cula">Media Matr√≠cula</option>
              <option value="Matr√≠cula completa">Matr√≠cula completa</option>
              <option value="Matr√≠cula completa + 1 cr√©dito">Matr√≠cula completa + 1C</option>
              <option value="Matr√≠cula completa + 2 cr√©ditos">Matr√≠cula completa + 2C</option>
              <option value="Matr√≠cula completa + 3 cr√©ditos">Matr√≠cula completa + 3C</option>
              <option value="Matr√≠cula completa + 4 cr√©ditos">Matr√≠cula completa + 4C</option>
            </select>
            <small style="color: gray;">Se asignar√°: {{ tipoMatricula }}</small>
          </div>

        </div>

        <div class="form-block">
          <div class="form-block-subtitle">Configuraci√≥n por Semestre</div>
          <div class="form-group">
            <label for="creditosInput">Cantidad M√°xima de Cr√©ditos a Inscribir</label>
            <input type="number" id="creditosInput" name="creditosInput" [(ngModel)]="creditosInput"
              [attr.max]="maxCreditos" (input)="ajustarCreditos()" min="1" />
            <small style="color: gray;">M√°ximo seg√∫n tipo de matr√≠cula: {{ maxCreditos }} cr√©ditos</small>
          </div>

          <div class="form-group">
            <label for="materiasInput">Cantidad M√°xima de Materias a Inscribir</label>
            <input type="number" id="materiasInput" name="materiasInput" [(ngModel)]="materiasInput" [attr.max]="maxMaterias" (input)="ajustarMaterias()" min="1" />
            <small style="color: gray;">L√≠mite m√°ximo: {{ maxMaterias }} materias</small>
          </div>
        </div>
      </div>
    </form>
  </section>

  <hr class="section-divider" />

  <section class="priorizacion-materias">
    <h2>Priorizaci√≥n de Materias</h2>
    <p>Selecciona las materias prioritarias para futuros semestres. Elije m√°ximo {{ maxSelecciones }} campos para mejorar la predicci√≥n en la simulaci√≥n.</p>
    <p><small style="color: gray;">Campos seleccionados: {{ seleccionesActuales }}/{{ maxSelecciones }}</small></p>
    
    <!-- Mensaje de error -->
    <p *ngIf="mostrarMensajeError" class="mensaje-error">
      Alcanzaste el m√°ximo de selecciones para priorizaci√≥n de materias
    </p>
    
    <div class="checkbox-group">
      <div>
        <input 
          type="checkbox" 
          id="prioridad-nucleo-basicas"
          [checked]="priorizacionMaterias.nucleoCienciasBasicas"
          (change)="onCheckboxChange('nucleoCienciasBasicas', $event)"
          [disabled]="!priorizacionMaterias.nucleoCienciasBasicas && seleccionesActuales >= maxSelecciones" 
        /> 
        <label for="prioridad-nucleo-basicas">
          N√∫cleo de Ciencias B√°sicas (ej. C√°lculos, F√≠sicas, Qu√≠micas)
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-nucleo-aplicada"
          [checked]="priorizacionMaterias.nucleoIngenieriaAplicada"
          (change)="onCheckboxChange('nucleoIngenieriaAplicada', $event)"
          [disabled]="!priorizacionMaterias.nucleoIngenieriaAplicada && seleccionesActuales >= maxSelecciones" 
        /> 
        <label for="prioridad-nucleo-aplicada">
          N√∫cleo de Ingenier√≠a Aplicada (Espec√≠ficas de la carrera)
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-socio-humanistica"
          [checked]="priorizacionMaterias.nucleoSocioHumanistica"
          (change)="onCheckboxChange('nucleoSocioHumanistica', $event)"
          [disabled]="!priorizacionMaterias.nucleoSocioHumanistica && seleccionesActuales >= maxSelecciones" 
        /> 
        <label for="prioridad-socio-humanistica">
          N√∫cleo Socio-human√≠stica (ej. Teolog√≠as, √âticas)
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-electivas"
          [checked]="priorizacionMaterias.electivas"
          (change)="onCheckboxChange('electivas', $event)"
          [disabled]="!priorizacionMaterias.electivas && seleccionesActuales >= maxSelecciones" 
        /> 
        <label for="prioridad-electivas">
          Electivas
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-complementarias"
          [checked]="priorizacionMaterias.complementarias"
          (change)="onCheckboxChange('complementarias', $event)"
          [disabled]="!priorizacionMaterias.complementarias && seleccionesActuales >= maxSelecciones" 
        /> 
        <label for="prioridad-complementarias">
          Complementarias
        </label>
      </div>

      <div>
        <input 
          type="checkbox" 
          id="prioridad-enfasis"
          [checked]="priorizacionMaterias.enfasis"
          (change)="onCheckboxChange('enfasis', $event)"
          [disabled]="!priorizacionMaterias.enfasis && seleccionesActuales >= maxSelecciones" 
        /> 
        <label for="prioridad-enfasis">
          √ânfasis
        </label>
      </div>
    </div>
  </section>

  <button class="simulacion-button" (click)="generarSimulacion()">Generar Simulaci√≥n</button>

  <div class="modal-backdrop" *ngIf="camposIncompletos">
    <div class="modal-custom">
      <h3>Campos incompletos</h3>
      <p>Completa todos los campos de 'Nombre de Simulaci√≥n' y 'Preferencias Acad√©micas' antes de generar la simulaci√≥n</p>
      <button (click)="camposIncompletos = false">Cerrar</button>
    </div>
  </div>
</div>